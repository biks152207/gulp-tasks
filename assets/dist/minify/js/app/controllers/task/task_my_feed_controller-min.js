(function(){app.controller("taskMyFeedController",["$rootScope","$q","$scope","taskService","connectivity","date","$ionicLoading","settingsService","project","sharedData","historyService","dbEnums","asyncStackService","$timeout",function(e,t,n,o,a,i,s,c,l,r,d,u,p,k){function f(){return a.isConnected()?d.getAllHistories(m,v,n.taskIds,n.projectIds).then(function(t){s.hide(),t.length?(t.forEach(function(e){e.icon=r.EVENT_ICONS[e.key],e.type==u.status.reopened&&(e.icon=r.EVENT_ICONS[e.type.toUpperCase()]),e.dateTime=i.getDateTime(e.date_modified),n.items.push(e)}),m+=v):n.noMoreItemsAvailable=!0,e.$broadcast("scroll.infiniteScrollComplete")}):(n.noMoreItemsAvailable=!0,void s.hide())}n.noMoreItemsAvailable=!1;var y=p.createStacker(),m=0,v=20;n.loadMore=function(){y.stack(f)},n.items=[],n.start=function(){n.title="My feeds",n.type="myFeed",s.show(),e.$emit("left-menu:selected",n.type),o.taskCount().then(function(t){e.$emit("task:header-taskList",n.type,t,null,!0)}),n.allFloatButtons=c.getSettings().float_button?parseInt(c.getSettings().float_button.value):null},n.start(),n.$on("$destroy",function(){S(),y.clear()});var S=e.$on("$stateChangeStart",function(){e.$emit("left-menu:selected",null)});n.getLink=function(e){var t="";return t="NOTE"==e.key?"#/task/note/"+e.task.id+("deleted"!=e.type?"?focusMe="+e.value.id:""):"complete"==e.type?"#/task/closed?tasks="+e.task.id:e.key==u.keys.TASK_DELETE?"javascript:void(0)":"#/task/edit/"+e.task.id+("reopen"==e.type?"?type=reopen":"")}}])}).call(this);