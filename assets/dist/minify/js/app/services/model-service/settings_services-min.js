(function(){app.service("settingsService",["$http","$rootScope","$state","$q","$window","API","RESPONSE_CODE","Upload","userModel","settingsModel","dbEnums","message","sync","connectivity","DEFAULTS",function(e,s,r,t,o,n,i,a,l,u,c,d,g,v,m){var E=this;E.items=[{title:"General",url:"/settings/general",icon:"tdzicon-tick"},{title:"My Account",url:"/settings/account",icon:"tdzicon-task-visibility"},{title:"Reminders",url:"/settings/reminder",icon:"tdzicon-reminder"},{title:"Notifications",url:"/settings/notifications",icon:"tdzicon-notifications"},{title:"About",url:"/settings/about",icon:"tdzicon-logo"}],E.defaultViews=[{title:"Inbox",value:"inbox"},{title:"Today",value:"today"},{title:"Next 7 days",value:"next7days"},{title:"Overdue",value:"overdue"},{title:"Favourites",value:"favourites"},{title:"All Tasks",value:""}],E.floatButtons=[{title:"Add task",value:0},{title:"Show all",value:1}],E.startDays=[{title:"Saturday",value:6},{title:"Sunday",value:0},{title:"Monday",value:1}],E.dateFormats=[{title:"dd mmm yyyy",value:0},{title:"mmm dd yyyy",value:1}],E.timeFormats=[{title:"12 hour",value:0},{title:"24 hour",value:1}],E.removeAvatar=function(s){var r=t.defer();return v.isConnected()?e.post(n.settings.removeAvatar,s).success(function(e){e.response_code===i.SUCCESS?r.resolve({error:!1,msg:d.successMessages.PROFILE_IMAGE_UPDATED}):e.response_code===i.ERROR&&r.resolve({error:!0,msg:d.errorMessages.GENERAL,results:e})}).error(function(e){r.resolve({error:!0,msg:d.errorMessages.GENERAL,results:e})}):r.resolve({error:!0,msg:d.errorMessages.CONNECTION_REQUIRED}),r.promise},E.update=function(e){var s=t.defer();return g.add(c.collections.Settings,{settings:e,userId:l.getLoggedInId()},c.events.Settings.update),u.addOrUpdate(e,function(){s.resolve()}),s.promise},E.updateEmail=function(s){var r=t.defer();return v.isConnected()?e.post(n.settings.updateEmail,s).success(function(e){e.response_code===i.SUCCESS?r.resolve({error:!1,msg:d.successMessages.EMAIL_UPDATE_REQUEST}):e.response_code===i.ERROR&&r.resolve({error:!0,msg:d.errorMessages[e.errors.value],results:e})}).error(function(e){r.resolve({error:!0,msg:d.errorMessages.GENERAL,results:e})}):r.resolve({error:!0,msg:d.errorMessages.CONNECTION_REQUIRED}),r.promise},E.updateItem=function(e){u.addOrUpdate(e,function(){})},E.updatePassword=function(s){var r=t.defer();return v.isConnected()?e.post(n.settings.updatePassword,s).success(function(e){e.response_code===i.SUCCESS?r.resolve({error:!1,msg:d.successMessages.PASSWORD_UPDATED}):e.response_code===i.ERROR&&r.resolve({error:!0,msg:d.errorMessages[e.errors.value],results:e})}).error(function(e){r.resolve({error:!0,msg:d.errorMessages.GENERAL,results:e})}):r.resolve({error:!0,msg:d.errorMessages.CONNECTION_REQUIRED}),r.promise},E.updateUserName=function(s){var r=t.defer();return v.isConnected()?e.post(n.settings.updateUserName,s).success(function(e){e.response_code===i.SUCCESS?r.resolve({error:!1,msg:d.successMessages.NAME_UPDATED}):e.response_code===i.ERROR&&r.resolve({error:!0,msg:d.errorMessages.GENERAL,results:e})}).error(function(e){r.resolve({error:!0,msg:d.errorMessages.GENERAL,results:e})}):r.resolve({error:!0,msg:d.errorMessages.CONNECTION_REQUIRED}),r.promise},E.uploadAvatar=function(e){var s=t.defer();return v.isConnected()?a.upload({url:n.settings.uploadAvatar,fields:e,file:e.file}).success(function(e){console.log(e),e.response_code==i.SUCCESS?s.resolve({error:!1,msg:d.successMessages.PROFILE_IMAGE_UPDATED}):e.response_code===i.ERROR&&s.resolve({error:!0,msg:d.errorMessages[e.errors.value],results:e})}).error(function(){s.resolve({error:!0,msg:d.errorMessages.GENERAL,results:results})}):s.resolve({error:!0,msg:d.errorMessages.CONNECTION_REQUIRED}),s.promise},E.updateSort=function(e){var s=t.defer();return g.add(c.collections.Settings,{sort:e.sort,userId:l.getLoggedInId()},c.events.Settings.sortUpdate),u.addOrUpdate(e,function(){s.resolve()}),s.promise},E.getSettings=function(){var e=JSON.parse(o.localStorage.getItem("settings"));return!e||!e.reminder||e.reminder.taskCreateReminderNotificationChannels&&e.reminder.taskCreateReminderNotificationChannels.email.title||(e.reminder.taskCreateReminderNotificationChannels=m.defaultSettings.taskCreateReminderNotificationChannels),e},E.deleteAccount=function(s){var r=t.defer();return e.post(n.settings.deleteAccount,s).success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise},E.validateDeleteAccount=function(s){var r=t.defer();return e.post(n.settings.checkForDelete,s).success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise}}])}).call(this);