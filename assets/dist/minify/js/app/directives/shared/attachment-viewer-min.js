(function(){function e(e,n){e+="";var t=["pdf"],i=[],a=[];"android"==n?a=a.concat(t):"ios"==n&&(a=a.concat(i));var l=e.lastIndexOf(".");if(l<0)return!0;var c=e.substr(l+1,3);return!(a.indexOf(c.toLowerCase())>-1)}app.directive("tdzAttachmentViewer",["$ionicModal","platformService","CONSTANT","authService",function(n,t,i,a){return{scope:{fileName:"=",fileUrl:"="},transclude:!0,require:"^tdzAttachmentViewer",template:'<div class="attachment-content"><div ng-if="isAnImage" style="height:auto"><img ng-src="{{fullFileUrl}}" class="attachment-thumbnail" ng-click="openAttachment($event)"/></br></div><span class="icon tdzicon-attach attachment-icon-left" ng-if="!isAnImage">&nbsp;<br/></span><div ng-click="openAttachment($event)" class="all-wrapped attachment-filename">{{fileName}}</div><ng-transclude></ng-transclude></div>',controller:["$scope",function(e){var n=this;n.isAnImage=function(e){var n=["jpg","gif","png","jpeg"],t=e.substring(e.lastIndexOf(".")+1).toLowerCase();return n.indexOf(t)!==-1},e.$watch("fileName",function(t,i){t!==i&&(e.isAnImage=n.isAnImage(t))}),e.$watch("fileUrl",function(n,t){if(n){var l=a.getAccessToken();e.fullFileUrl=i.file_handler_link+"/attachment?x-access-token="+l+"&url="+n}}),e.isAnImage=n.isAnImage(e.fileName)}],link:function(t,i,a,l){function c(){n.fromTemplateUrl("html/directives/shared/attachment-viewer.html",function(e){t.modal=e,t.modal.show()},{scope:t,animation:"scale-in"})}var o=l;t.openAttachment=function(e){return e.stopPropagation(),o.isAnImage(t.fileName)?(t.src=t.fullFileUrl,void c()):void t.openFile()},t.openFile=function(){if(window.cordova){console.log("opening file ::: "+t.fullFileUrl);var n=(e(t.fullFileUrl,"android"),t.fullFileUrl);window.open(encodeURI(n),"_system","location=no")}else window.open(t.fullFileUrl,"_blank")}}}}])}).call(this);