(function(){app.constant("msdElasticConfig",{append:""}),app.directive("msdElastic",["$timeout","$window","msdElasticConfig",function(e,t,o,r){"use strict";return{require:"ngModel",restrict:"A, C",link:function(o,n,i,a){function l(){var e=m;h=p,x=getComputedStyle(p),angular.forEach(C,function(t){e+=t+":"+x.getPropertyValue(t)+";"}),w.setAttribute("style",e)}function s(){var t,r,n,i,a;h!==p&&l(),c||(c=!0,w.value=p.value+y,w.style.overflowY=p.style.overflowY,t=""===p.style.height?"auto":parseInt(p.style.height,10),r=getComputedStyle(p).getPropertyValue("width"),"px"===r.substr(r.length-2,2)&&(i=parseInt(r,10)-P.width,w.style.width=i+"px"),n=w.scrollHeight,n>E?(n=E,a="scroll"):n<$&&(n=$),n+=P.height,p.style.overflowY=a||"hidden",t!==n&&(p.style.height=n+"px",o.$emit("elastic:resize",g)),o.$emit("taResize",g),e(function(){c=!1},1))}function d(){c=!1,s()}var p=n[0],g=n;if("TEXTAREA"===p.nodeName&&t.getComputedStyle){g.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var u=p.value;p.value="",p.value=u;var h,c,y=i.msdElastic?i.msdElastic.replace(/\\n/g,"\n"):r.append,b=angular.element(t),m="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden; -webkit-box-sizing: content-box;-moz-box-sizing: content-box; box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0;",f=angular.element('<textarea tabindex="-1" style="'+m+'"/>').data("elastic",!0),w=f[0],x=getComputedStyle(p),v=x.getPropertyValue("resize"),V="border-box"===x.getPropertyValue("box-sizing")||"border-box"===x.getPropertyValue("-moz-box-sizing")||"border-box"===x.getPropertyValue("-webkit-box-sizing"),P=V?{width:parseInt(x.getPropertyValue("border-right-width"),10)+parseInt(x.getPropertyValue("padding-right"),10)+parseInt(x.getPropertyValue("padding-left"),10)+parseInt(x.getPropertyValue("border-left-width"),10),height:parseInt(x.getPropertyValue("border-top-width"),10)+parseInt(x.getPropertyValue("padding-top"),0)+parseInt(x.getPropertyValue("padding-bottom"),0)+parseInt(x.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},z=parseInt(x.getPropertyValue("min-height"),10),I=parseInt(x.getPropertyValue("height"),10),$=Math.max(z,I)-P.height,E=parseInt(x.getPropertyValue("max-height"),10),C=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];g.data("elastic")||(E=E&&E>0?E:9e4,w.parentNode!==document.body&&angular.element(document.body).append(w),g.css({resize:"none"===v||"vertical"===v?"none":"horizontal"}).data("elastic",!0),"onpropertychange"in p&&"oninput"in p?p.oninput=p.onkeyup=s:p.oninput=s,b.bind("resize",d),o.$watch(function(){return a.$modelValue},function(e){d()}),o.$on("elastic:adjust",function(){l(),d()}),e(s),o.$on("$destroy",function(){f.remove(),b.unbind("resize",d)}))}}}}])}).call(this);